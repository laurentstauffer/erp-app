<div class="page">
  <h2>Projets</h2>
  <table>
    <thead>
      <tr><th>ID</th><th>Nom</th><th>Description</th></tr>
    </thead>
    <tbody>
      <tr *ngFor="let project of projects">
        <td>{{ project.id }}</td>
        <td>{{ project.name }}</td>
        <td>{{ project.description }}</td>
      </tr>
    </tbody>
  </table>
</div>


<div class="project-list-container">
  <button class="add-project-button" (click)="toggleProjectForm()">
    {{ showProjectForm ? 'Fermer Formulaire' : 'Add Project' }}
  </button>

  <app-project-form 
    *ngIf="showProjectForm" 
    [projectToEdit]="projectToEdit"
    (projectSaved)="onProjectSaved()">
  </app-project-form>

<div *ngFor="let project of projects" class="project-card">
  <div class="project-header">
    <h3>{{ project.name }}</h3>
    <button class="edit-button" (click)="editProject(project)">‚úèÔ∏è Modifier</button>
  </div>
  <p class="project-dates">
    Du <strong>{{ project.startDate | date:'dd.MM.yyyy' }}</strong>
    au <strong>{{ project.endDate | date:'dd.MM.yyyy' }}</strong>
  </p>

  <!-- Formulaire d'ajout de t√¢che -->
  <app-task-form [projectId]="project.id!"></app-task-form>

  <!-- Liste des t√¢ches -->
  <div class="tasks-container" *ngIf="project.tasks?.length; else noTasks">
    <div *ngFor="let task of project.tasks" class="task-card">
      <div class="task-header">
        <h4>{{ task.name }}</h4>
        <span class="status" [class.done]="task.done">
          {{ task.done ? '‚úÖ Termin√©e' : 'üïõ En cours' }}
        </span>
      </div>

      <div class="task-details">
        <p><strong>Dur√©e :</strong> {{ task.duration }} jour{{ task.duration > 1 ? 's' : '' }}</p>
        <p *ngIf="task.dueDate"><strong>√âch√©ance :</strong> {{ task.dueDate | date:'dd.MM.yyyy' }}</p>
        <p><strong>ID :</strong> {{ task.id }}</p>
        <p><strong>Projet :</strong> {{ task.projectId }}</p>
      </div>
    </div>
  </div>

  <ng-template #noTasks>
    <p class="no-tasks">Aucune t√¢che pour ce projet.</p>
  </ng-template>
</div>


</div>
